# 🚀 Dart-B 2024-1st Toyproject <Ideal location Recommendation for ; Photobooth>

## 📚 목차

1. [기획배경](#기획배경)
2. [프로젝트 기간](#프로젝트-기간)
3. [팀원 소개](#팀원-소개)
4. [기능 소개](#기능-소개)
5. [모델 설계서](#모델-설계서)
6. [API 설계서](#api-설계서)
7. [ERD](#erd)
8. [시스템 아키텍처](#시스템-아키텍처)
9. [데이터 명세서](#데이터-명세서)
10. [기술 스택](#기술-스택)
11. [결과물](#결과물)

## 🎯 기획배경

" 왜 중앙대학교 후문에는 포토부스가 하나도 없을까? 내가 세우면 사람들이 오려나? "

- “이따 사진 한 장 찍을까?”
당연시되고 있는 우리 주위의 포토부스.
셀프 포토부스가 성행하는 시점에서 어떤 요소가 포토부스의 입점에 관련되어 있고,
새롭게 포토부스를 설치하고자 한다면 어디에 입점시키는 것이 가장 좋을까?
  
## ⏰ 프로젝트 기간

24년 3월 20일 (수) ~ 24년 4월 3일 (수)
2주 간 진행했습니다.

## 👥 팀원 소개

| 이름 | 역할 |
|---|---|
| 이은학(팀장) | 프론트엔드, 웹 서빙 |
| 심영보 | 데이터 사이언티스트(데이터 수집, 추천 모델링 개발) |
| 이유정 | 데이터 사이언티스트(데이터 수집, 정제, 시각화) |
| 김나현 | 데이터 애널리스트(데이터 시각화) |

## 🎁 기능 소개

| 기능 | 상세 설명 |
|---|---|
| 회원 관리 | 로그인 / 로그아웃 |
| 메인페이지 | 서비스 소개 및 팀원 소개 |
| 여행지 조회 및 상세 페이지 | 여행지 주소, 소개 등 기본정보 조회. 해당 여행지 카카오맵 마커 및 지도 표시. 해당 여행지와 비슷한 여행지 추천 |
| 여행지 길찾기 페이지 | 여행지 출발지, 도착지 키워드와 여러가지 교통 옵션으로 최적의 길찾기를 제공 |
| 마이페이지 | 사용자 기본정보 및 수정|
| 여행지 추천 | 인기 여행지 추천 |
| 챗봇 | ex) 액티비티 여행지 추천, 반려동물과 갈 수 있는 숙소 추천, 흑돼지 음식점 추천 등 |

## 📄 모델 설계서
  ### 데이터

데이터셋은 총 5가지를 사용했다.
1) 서울시 가구 특성정보 - 소득정보
2) 소상공인시장진흥공단_상가(상권)정보
3) 한국대학및전문대학정보표준데이터 & 전국초중등학교위치표준데이터
4) 상권별 소규모 상가 임대료
5) 서울시 상권분석서비스(추정매출-상권)

+ 서울시 내 랜덤 스팟의 포토부스 개수 및 상관 피쳐 개수 (300개)

##### 모델 학습 및 추론 결과



##### 모델 서빙 플로우 설계
![image](https://github.com/PlaydataFinal/Final_project/assets/145752714/a8348bdf-82f6-4212-8a64-40e29cda859b)


추천 모델 서빙 플로우. 유사도 행렬이 아니라 백터를 db에 저장해놓기로 했기 때문에 혹시 서비스 코드 실행 시 유사도 계산 및 sorting에 시간이 많이 걸리는지 관찰해야했다. 다행히 시간이 오래 걸리는 이슈는 없었다.
<br><br>


##### 추천서비스 로직 구성
이는 4x1473개의 계산된 유사도를 sorting한 것이다. row3에 대해서만 즉, 결국 한 관광지에 대한 추천만 하게 되는 문제가 있었다. 발라드, 힙합, 락 을 골랐는데 결국 발라드와 유사한 것들만 추천하게 되는 상황이었다. 편향 문제 개선을 위해 각각 추천해주는 방식으로 바꿨다.
<br><br>


##### Evaluation과 Future Work
-유저의 선택 데이터가 있었다면 협업 필터링이나 하이브리드 기법을 적용해볼 수 있었을텐데 실제 기업 비즈니스 과정이 아니어서 이를 실현하지 못 한 것이 아쉽다. 기회가 된다면 협업 필터링이나 하이브리드 기법을 구현해보고 싶다. A/B test 같은 성능 평가도 해보고 싶다.<br>
<br>
-태그 유사도, 텍스트 유사도를 동시에 고려한 추천시스템을 구성해보고 결과를 확인해보고 싶었으나 이미지 유사도에 치중하느라 달성하지 못했다.<br>
<br>
-최종적인 관광지 추천에서 특정 관광지에 편향이 생기는 이슈를 교정하였다. 다만 실제 더욱 복잡한 input 데이터를 다루는 상황에서는 더 정교한 추천 로직 구성이 요구될 것이다. 실제 기업에서 쓰는 추천 로직을 추가적으로 조사해볼 것이다.<br>
<br>
-기업 활동이 아니어서 사실상 추천시스템의 성능 테스트가 부재중이라는 점이 아쉽다.<br>
<br>
-AiHub에서 찾은 여행 경로 데이터를 가지고 관광지 간 사회연결망 분석, 관광지 클러스터링 등을 궁리했으나 서비스화하지 못했다.<br>
<br>
-추천시스템과 이미지 분류에 있어 SOTA라 할 수 있는 transformer를 고려하지 않았다. 선도적인 모델을 찾아서 적용하는 것보다 조금은 구식의 모델이라도 직접 구조와 이론을 공부하고 해당 맥락에서 참신한 플로우를 짜기 위해 치열하게 고민해보는 것이 좀 더 내실있는 과정이라고 생각했기 때문이다. 또한 이렇게 직접 설계하고 구현해낸 경험은 이후 SOTA 모델을 활용하고 그 이상을 뚫기 위한 제반이 될 것이다. 


  ### 💬 챗봇

  ![001](https://github.com/PlaydataFinal/Final_project/assets/147587058/4a480aa5-5488-4923-8350-61bd02245fdb)
  ![002](https://github.com/PlaydataFinal/Final_project/assets/147587058/d5826717-4c6c-4f84-8c47-99f85b138579)
  ![003](https://github.com/PlaydataFinal/Final_project/assets/147587058/d793e093-79b9-4359-b8d4-e873a751aa48)

-------
![004](https://github.com/PlaydataFinal/Final_project/assets/147587058/2be2787b-af39-4caf-8c34-2605d40965ed)
![005](https://github.com/PlaydataFinal/Final_project/assets/147587058/fd49b37b-e290-4637-b651-dcdd07ac4961)
<br><br>
##### 챗봇 모델 설계
![마](https://github.com/PlaydataFinal/Final_project/assets/145752714/533c6fef-1018-4cad-ae13-94e4f0fe6d8e)
<br><br>
##### 챗봇 모델 서빙 플로우
![마용](https://github.com/PlaydataFinal/Final_project/assets/145752714/43f1428b-8c53-4a23-b244-9180b9785694)
<br><br>
## 🌐 API 설계서

### 카카오 API
- **기능**: 키워드 검색을 통한 관광지 위치 조회 및 상세페이지 이동 가능 
- **요청 URL**: `https://dapi.kakao.com/v2/maps/sdk.js?appkey=5b475d258fb5e345e3944cb9418a3f5b&libraries=services`
- **요청 방식**: GET
- **요청 파라미터**: `query` (검색어)
- **응답 형식**: JSON
- **에러 코드**: 401 (인증 실패), 404 (찾을 수 없음)

### tmap API
- **기능**:키워드를 통한 길찾기 (여러가지 옵션 포함)
- **요청 URL**:
  - 네이버: `https://nid.naver.com/oauth2.0/authorize`
  - 카카오: `https://kauth.kakao.com/oauth/authorize`
  - 구글: `https://accounts.google.com/o/oauth2/auth`
- **요청 방식**: GET
- **요청 파라미터**: `client_id`, `redirect_uri`, `response_type`, `scope`
- **응답 형식**: JSON
- **에러 코드**: 400 (잘못된 요청), 401 (인증 실패)

### GEMINI-Pro API
- **기능**: 챗봇 기능
- **요청 URL**: `https://api.gemini.com/v1/pubticker/:symbol`
- **요청 방식**: GET
- **요청 파라미터**: `symbol` (디지털 자산 심볼)
- **응답 형식**: JSON
- **에러 코드**: 400 (잘못된 요청), 403 (권한 없음), 404 (찾을 수 없음)

## 🗃️ ERD
<img width="1131" alt="스크린샷 2024-03-20 오후 12 44 56" src="https://github.com/PlaydataFinal/Final_project/assets/102157695/d7aef3ee-3ea7-46b9-9578-e951e36980fb">


## 🏗️ 시스템 아키텍처

![웹아키택처](https://github.com/PlaydataFinal/Final_project/assets/102157695/bfbffeb6-0499-4a1b-bc66-59232983cd82)

- docker(t2.2xLarge): 개발환경을 좀 더 원활하고 빠르게 작업하기위해 도커 환경에서 was,web, mariadb를 구축
- nginx(web server):
  역할: 역방향 프록시 및 로드 밸런서 역할을 수행합니다.
  기능: 클라이언트로부터의 HTTP 요청을 받아 백엔드 웹 서버(web1, web2, web3)로 전달하며, 로드 밸런싱을 통해 요청을 분산합니다. 또한 정적 파일을 제공하기 위해 정적 파일 볼륨을 마운트하고 있습니다.
- web1, web2, web3 (was server):
  역할: Django 애플리케이션을 실행하는 웹 서버 역할을 합니다.
  기능: Django 애플리케이션을 실행하고 클라이언트로부터의 HTTP 요청을 처리합니다. 각각의 웹 서버는 Gunicorn을 사용하여 Django 애플리케이션을 실행하고 있습니다. 각 웹 서버는 다른 포트(8001, 8002, 8003)에서 실행됩니다.
- rabbitmq:
  역할: 메시지 큐 시스템인 RabbitMQ를 실행합니다.
  기능: 비동기 작업 처리를 위해 Celery와 함께 사용됩니다. Celery 작업 큐와 브로커로서의 역할을 합니다.
- redis:
  역할: 인메모리 데이터 구조 스토어인 Redis를 실행합니다.
  기능: 데이터 캐싱 및 세션 관리 등 다양한 용도로 사용될 수 있습니다.
- celery_worker:
  역할: Celery 워커로 비동기 작업을 처리합니다.
  기능: Celery를 사용하여 백그라운드에서 비동기 작업을 처리합니다. RabbitMQ 브로커와 통신하여 작업을 받아 처리합니다.
- celery_beat:
  역할: Celery 스케줄러로 주기적인 작업을 실행합니다.
  기능: Celery Beat를 사용하여 정기적으로 실행되어야 하는 작업을 스케줄링합니다.
- flower:
  역할: Celery 모니터링 도구인 Flower를 실행합니다.
  기능: Celery 작업 및 큐의 상태를 모니터링하고 관리할 수 있는 웹 인터페이스를 제공합니다.
- MongoDB:
  역할: 챗봇 학습을 위한 데이터 저장 (백터 데이터베이스)
  기능: 백터 데이터베이스에 관련된 정보를 보호합니다.
- MariaDB:
  역할: 웹 서비스에 제공할 데이터 저장
  기능: 사용자 정보 및 관광지, 음식점, 숙박업소 정보를 안전하게 보호합니다.
- Colab Pro:
  역할: 안정적이고 빠른 학습 환경 제공
  기능: 구글 코랩을 통해 학습을 효율적으로 수행하고 안정성을 확보합니다.
- Airflow:
  역할: 데이터 수집 자동화
  기능: 데이터 수집을 정해진 시간에 맞추어 업데이트합니다.
## 📄 데이터 명세서

### 1. 관광지(음식점, 숙박) 기본 데이터

- **항목**: 관광지(음식점, 숙박) 기본 데이터
- **칼럼**: 이름, 별점, 태그, 주소, 전화번호, 좋아요, 찜하기, 리뷰, 방문자, 조회, SNS공유, 상세설명, 이용안내, 이미지URL, 설명 핵심 키워드
- **갯수**: 1488
- **데이터타입**:
  - 이름, 별점, 태그, 주소, 전화번호, 좋아요, 찜하기, 리뷰, 방문자, SNS공유, 상세설명, 이용안내, 이미지URL, 설명 핵심 키워드: object
  - 조회: float

### 2. 관광지 설명 데이터

- **항목**: 관광지 설명 데이터
- **칼럼**: ID, 이름, 주소, 위도, 경도, 전화번호, 이미지URL
- **갯수**: 1480
- **데이터타입**:
  - ID: int (웹페이지 구분자)
  - 이름, 주소, 위도, 경도, 전화번호, 이미지URL: object

### 3. 챗봇 데이터

- **항목**: 챗봇 데이터
- **칼럼**: 이름, 주소, 조회, 상세설명, 이용안내, 임베딩, 태그임베딩
- **갯수**: 1487
- **데이터타입**:
  - 이름, 주소, 이용안내, 상세설명: object
  - 조회: float
  - 임베딩, 태그임베딩: array

### 4. 이미지 추천 데이터

- **항목**: 이미지 추천 데이터
- **칼럼**: 이름, 이미지URL, 이미지임베딩, 관광지간 유사도
- **갯수**: 1472
- **데이터타입**:
  - 이름, 이미지URL: object
  - 이미지임베딩: array
  - 관광지간 유사도: object

### 5. 관광지별 추천 데이터

- **항목**: 관광지별 추천 데이터
- **칼럼**: ID, 이름, 태그, 조회, 임베딩, 태그임베딩, 유사관광지1, 유사관광지2, 유사관광지3, 유사관광지1의 유사도, 유사관광지2의 유사도, 유사관광지3의 유사도
- **갯수**: 1465
- **데이터타입**:
  - ID: object (웹페이지 구분자)
  - 조회: float
  - 임베딩(설명 핵심키워드의 임베딩 값), 태그 임베딩(태그 임베딩 값): array
  - 이름, 태그, 유사관광지1, 유사관광지2, 유사관광지3(각 관광지별 유사 관광지), 유사관광지1의 유사도, 유사관광지2의 유사도, 유사관광지3의 유사도(각 관광지별 유사 관광지 유사도): object

## 💻 기술 스택

| 분류 | 항목 |
|---|---|
| FRONT-END | Tmap API,KAKAO API, HTML, CSS |
| BACK-END | Django, Python, Kakao API, GEMINI-Pro API, Tmap API |
| DATA | Python, MySQL(Maria DB), MongoDB |
| CI/CD | Docker, AWS S3 |
| 협업 | Slack, Git |

## 🎈 결과물

(결과물 내용)
